<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title data-i18n="title">æ‰¹é‡å½±ç‰‡å­—å¹•ç”Ÿæˆå™¨</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans&family=Noto+Sans+SC&family=Noto+Sans+TC&family=Noto+Sans+JP&family=Noto+Sans+KR&family=Noto+Sans+Devanagari&family=Noto+Sans+Thai&display=swap" rel="stylesheet">
  <style>
    body { 
      font-family: 'Noto Sans', 'Noto Sans SC', 'Noto Sans TC', 'Noto Sans JP', 'Noto Sans KR', 'Noto Sans Devanagari', 'Noto Sans Thai', sans-serif; 
      max-width: 900px; 
      margin: 2em auto; 
      line-height: 1.6; 
      padding: 0 20px;
      background-color: #f5f5f5;
    }
    .container { 
      background: white;
      border: 1px solid #ddd; 
      padding: 30px; 
      border-radius: 12px; 
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    h1, h2 { text-align: center; color: #333; }
    h1 { margin-bottom: 10px; }
    .subtitle { text-align: center; color: #666; margin-bottom: 30px; }
    #languageSelect {
      display: block;
      margin: 0 auto 20px;
      padding: 8px;
      font-size: 16px;
      border-radius: 6px;
      width: 200px;
    }
    .file-upload-wrapper {
      margin: 1.5em 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    input[type="file"] { 
      display: none;
    }
    button[data-i18n="browse"] {
      padding: 10px 20px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
    }
    button[data-i18n="browse"]:hover {
      background-color: #0056b3;
    }
    #file-status {
      color: #666;
    }
    button { 
      padding: 12px 20px; 
      background-color: #007bff; 
      color: white; 
      border: none; 
      border-radius: 6px; 
      cursor: pointer; 
      font-size: 16px;
      margin: 5px;
    }
    button:hover { background-color: #0056b3; }
    button:disabled { 
      background-color: #6c757d; 
      cursor: not-allowed; 
    }
    #status-container { 
      background: white;
      padding: 25px; 
      border-radius: 12px; 
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    #status-container p { margin: 0.8em 0; }
    .status-item { 
      display: flex; 
      justify-content: space-between; 
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid #eee;
    }
    .status-item:last-child { border-bottom: none; }
    .status-value { 
      font-weight: bold; 
      color: #007bff; 
    }
    .upload-status { 
      margin-top: 15px; 
      padding: 10px; 
      border-radius: 6px; 
      text-align: center;
    }
    .upload-status.success { background-color: #d4edda; color: #155724; }
    .upload-status.error { background-color: #f8d7da; color: #721c24; }
    .upload-status.info { background-color: #cce7ff; color: #004085; }
    .progress-section {
      margin-top: 20px;
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #007bff;
    }
    .current-file {
      font-weight: bold;
      color: #007bff;
      margin-bottom: 10px;
    }
    .progress-step {
      margin: 5px 0;
      font-size: 14px;
    }
    #completed-videos-section {
      margin-top: 20px;
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 8px;
    }
    #completed-videos-section table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    #completed-videos-section th, #completed-videos-section td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: left;
    }
    #completed-videos-section th {
      background-color: #007bff;
      color: white;
    }
    #completed-videos-section tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    #completed-videos-section tr:hover {
      background-color: #f1f1f1;
    }
    .subtitle-settings {
      margin: 1.5em 0;
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #007bff;
    }
    .subtitle-language {
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .subtitle-language label {
      font-weight: bold;
      color: #333;
      min-width: 100px;
    }
    .subtitle-language select, .subtitle-language input[type="number"], .subtitle-language input[type="color"] {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
    }
    .subtitle-language input[type="number"] {
      width: 80px;
    }
    .subtitle-language input[type="color"] {
      width: 50px;
      height: 30px;
      padding: 2px;
    }
    #subtitle-order {
      margin-top: 15px;
      padding: 10px;
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 6px;
    }
    .order-item {
      padding: 10px;
      background-color: #007bff;
      color: white;
      border-radius: 6px;
      margin: 5px;
      cursor: move;
      display: inline-block;
      user-select: none;
    }
    .order-item.dragging {
      opacity: 0.5;
    }
  </style>
</head>
<body>
  <div class="container">
    <select id="languageSelect">
      <option value="en">English</option>
      <option value="fr">FranÃ§ais</option>
      <option value="es">EspaÃ±ol</option>
      <option value="de">Deutsch</option>
      <option value="it">Italiano</option>
      <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
      <option value="zh-TW" selected>ç¹é«”ä¸­æ–‡</option>
      <option value="ja">æ—¥æœ¬èª</option>
      <option value="ko">í•œêµ­ì–´</option>
      <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
      <option value="th">à¹„à¸—à¸¢</option>
    </select>
    <h1 data-i18n="title">æ‰¹é‡å½±ç‰‡å­—å¹•ç”Ÿæˆå™¨</h1>
    <p class="subtitle" data-i18n="subtitle">é¸æ“‡å¤šå€‹å½±ç‰‡æª”æ¡ˆï¼Œè‡ªå‹•ç”Ÿæˆä¸­æ–‡ã€è‹±æ–‡å’Œæ³•æ–‡å­—å¹•</p>
    <div class="file-upload-wrapper">
      <input type="file" id="video-files" accept="video/*" multiple>
      <button data-i18n="browse">ç€è¦½</button>
      <span id="file-status" data-i18n="noFilesSelected">ç„¡æª”æ¡ˆé¸æ“‡</span>
    </div>
    <div class="subtitle-settings">
      <h2 data-i18n="subtitleSettings">å­—å¹•è¨­å®š</h2>
      <div class="subtitle-language">
        <label data-i18n="zhLabel">ä¸­æ–‡</label>
        <select id="zh-font">
          <option value="Noto Sans TC">Noto Sans TC</option>
          <option value="Arial">Arial</option>
          <option value="Times New Roman">Times New Roman</option>
          <option value="Noto Sans SC">Noto Sans SC</option>
          <option value="Noto Sans JP">Noto Sans JP</option>
          <option value="Noto Sans KR">Noto Sans KR</option>
        </select>
        <label data-i18n="sizeLabel">å­—é«”å¤§å°</label>
        <input type="number" id="zh-size" min="10" max="48" step="2" value="24">
        <label data-i18n="colorLabel">é¡è‰²</label>
        <input type="color" id="zh-color" value="#FFFF00">
      </div>
      <div class="subtitle-language">
        <label data-i18n="enLabel">è‹±æ–‡</label>
        <select id="en-font">
          <option value="Arial">Arial</option>
          <option value="Noto Sans TC">Noto Sans TC</option>
          <option value="Times New Roman">Times New Roman</option>
          <option value="Noto Sans SC">Noto Sans SC</option>
          <option value="Noto Sans JP">Noto Sans JP</option>
          <option value="Noto Sans KR">Noto Sans KR</option>
        </select>
        <label data-i18n="sizeLabel">å­—é«”å¤§å°</label>
        <input type="number" id="en-size" min="10" max="48" step="2" value="20">
        <label data-i18n="colorLabel">é¡è‰²</label>
        <input type="color" id="en-color" value="#FFFFFF">
      </div>
      <div class="subtitle-language">
        <label data-i18n="frLabel">æ³•æ–‡</label>
        <select id="fr-font">
          <option value="Times New Roman">Times New Roman</option>
          <option value="Noto Sans TC">Noto Sans TC</option>
          <option value="Arial">Arial</option>
          <option value="Noto Sans SC">Noto Sans SC</option>
          <option value="Noto Sans JP">Noto Sans JP</option>
          <option value="Noto Sans KR">Noto Sans KR</option>
        </select>
        <label data-i18n="sizeLabel">å­—é«”å¤§å°</label>
        <input type="number" id="fr-size" min="10" max="48" step="2" value="20">
        <label data-i18n="colorLabel">é¡è‰²</label>
        <input type="color" id="fr-color" value="#00FFFF">
      </div>
      <div id="subtitle-order">
        <label data-i18n="orderLabel">å­—å¹•æ’åˆ—é †åºï¼ˆæ‹–æ›³èª¿æ•´ï¼‰</label>
        <div id="order-list">
          <div class="order-item" draggable="true" data-lang="zh" data-i18n="zhLabel">ä¸­æ–‡</div>
          <div class="order-item" draggable="true" data-lang="en" data-i18n="enLabel">è‹±æ–‡</div>
          <div class="order-item" draggable="true" data-lang="fr" data-i18n="frLabel">æ³•æ–‡</div>
        </div>
      </div>
    </div>
    <div style="text-align: center;">
      <button onclick="uploadVideos()" id="upload-btn" data-i18n="uploadButton">ğŸ“¤ ä¸Šå‚³ä¸¦é–‹å§‹è™•ç†</button>
    </div>
    <div id="upload-status-container"></div>
  </div>

  <div id="status-container">
    <h2 data-i18n="statusTitle">ğŸ“Š è™•ç†ç‹€æ…‹</h2>
    <div class="status-item">
      <span data-i18n="queueLabel"><strong>éšŠåˆ—ä¸­çš„å½±ç‰‡ï¼š</strong></span>
      <span class="status-value" id="queue-count">0</span>
    </div>
    <div class="status-item">
      <span data-i18n="pendingLabel"><strong>å¾…è™•ç†æª”æ¡ˆï¼š</strong></span>
      <span class="status-value" id="pending-count">0</span>
    </div>
    <div class="status-item">
      <span data-i18n="completedLabel"><strong>å·²å®Œæˆå½±ç‰‡ï¼š</strong></span>
      <span class="status-value" id="completed-count">0</span>
    </div>
    <div class="status-item">
      <span data-i18n="processingLabel"><strong>è™•ç†ç‹€æ…‹ï¼š</strong></span>
      <span class="status-value" id="processing-status">ç©ºé–’</span>
    </div>
    <div id="progress-section" class="progress-section" style="display: none;">
      <div class="current-file" id="current-file"></div>
      <div class="progress-step" id="progress-step"></div>
    </div>
    <div id="completed-videos-section">
      <h2 data-i18n="completedTitle">ğŸ“‹ å·²å®Œæˆå½±ç‰‡</h2>
      <table id="completed-videos-table">
        <thead>
          <tr>
            <th data-i18n="tableOriginalFile">åŸå§‹æª”æ¡ˆ</th>
            <th data-i18n="tableNewFile">æ–°æª”æ¡ˆ</th>
            <th data-i18n="tableDuration">è½‰æ›è€—æ™‚ï¼ˆç§’ï¼‰</th>
          </tr>
        </thead>
        <tbody id="completed-videos-body"></tbody>
      </table>
      <div style="text-align: center; margin-top: 20px;">
        <button onclick="exportToExcel()" data-i18n="exportButton">ğŸ“¥ åŒ¯å‡ºç‚º Excel</button>
      </div>
    </div>
    <div style="text-align: center; margin-top: 20px;">
      <button onclick="fetchStatus()" data-i18n="refreshButton">ğŸ”„ åˆ·æ–°ç‹€æ…‹</button>
    </div>
  </div>

  <script>
    const translations = {
      en: {
        title: "Batch Video Subtitle Generator",
        subtitle: "Select multiple video files to automatically generate Chinese, English, and French subtitles",
        uploadButton: "ğŸ“¤ Upload and Start Processing",
        statusTitle: "ğŸ“Š Processing Status",
        queueLabel: "Videos in Queue:",
        pendingLabel: "Pending Files:",
        completedLabel: "Completed Videos:",
        completedTitle: "ğŸ“‹ Completed Videos",
        processingLabel: "Processing Status:",
        tableOriginalFile: "Original File",
        tableNewFile: "New File",
        tableDuration: "Processing Time (seconds)",
        exportButton: "ğŸ“¥ Export to Excel",
        refreshButton: "ğŸ”„ Refresh Status",
        noData: "No completed videos yet",
        browse: "Browse",
        noFilesSelected: "No files selected",
        uploadSelect: "Please select video files to upload",
        uploadProcessing: "Uploading {count} file(s)...",
        uploadSuccess: "Upload successful",
        uploadError: "Upload failed, please try again",
        exportNoData: "No data to export",
        exportSuccess: "Completed videos list exported",
        statusError: "Failed to fetch status",
        processingIdle: "Idle",
        processingQueue: "Waiting in queue",
        progress_starting: "ğŸš€ Starting processing...",
        progress_extracting_audio: "ğŸµ Extracting audio...",
        progress_transcribing: "ğŸ“ Transcribing audio to text...",
        progress_translating_en: "ğŸŒ Translating to English...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· Translating to French...",
        progress_merging_subtitles: "ğŸ¬ Merging subtitles into video...",
        progress_generic: "ğŸ“Š Processing... ({progress}%)",
        subtitleSettings: "Subtitle Settings",
        zhLabel: "Chinese",
        enLabel: "English",
        frLabel: "French",
        sizeLabel: "Font Size",
        colorLabel: "Color",
        orderLabel: "Subtitle Order (Drag to Adjust)"
      },
      fr: {
        title: "GÃ©nÃ©rateur de sous-titres vidÃ©o en lot",
        subtitle: "SÃ©lectionnez plusieurs fichiers vidÃ©o pour gÃ©nÃ©rer automatiquement des sous-titres en chinois, anglais et franÃ§ais",
        uploadButton: "ğŸ“¤ TÃ©lÃ©charger et commencer le traitement",
        statusTitle: "ğŸ“Š Ã‰tat du traitement",
        queueLabel: "VidÃ©os en file d'attente :",
        pendingLabel: "Fichiers en attente :",
        completedLabel: "VidÃ©os terminÃ©es :",
        processingLabel: "Ã‰tat du traitement :",
        tableOriginalFile: "Fichier original",
        tableNewFile: "Nouveau fichier",
        tableDuration: "Temps de traitement (secondes)",
        exportButton: "ğŸ“¥ Exporter vers Excel",
        refreshButton: "ğŸ”„ Actualiser l'Ã©tat",
        noData: "Aucune vidÃ©o terminÃ©e pour le moment",
        browse: "Parcourir",
        noFilesSelected: "Aucun fichier sÃ©lectionnÃ©",
        uploadSelect: "Veuillez sÃ©lectionner des fichiers vidÃ©o Ã  tÃ©lÃ©charger",
        uploadProcessing: "TÃ©lÃ©chargement de {count} fichier(s)...",
        uploadSuccess: "TÃ©lÃ©chargement rÃ©ussi",
        uploadError: "Ã‰chec du tÃ©lÃ©chargement, veuillez rÃ©essayer",
        exportNoData: "Aucune donnÃ©e Ã  exporter",
        exportSuccess: "Liste des vidÃ©os terminÃ©es exportÃ©e",
        statusError: "Ã‰chec de la rÃ©cupÃ©ration de l'Ã©tat",
        processingIdle: "Inactif",
        processingQueue: "En attente dans la file",
        progress_starting: "ğŸš€ DÃ©but du traitement...",
        progress_extracting_audio: "ğŸµ Extraction de l'audio...",
        progress_transcribing: "ğŸ“ Transcription de l'audio en texte...",
        progress_translating_en: "ğŸŒ Traduction en anglais...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· Traduction en franÃ§ais...",
        progress_merging_subtitles: "ğŸ¬ Fusion des sous-titres dans la vidÃ©o...",
        progress_generic: "ğŸ“Š Traitement... ({progress}%)",
        subtitleSettings: "ParamÃ¨tres des sous-titres",
        zhLabel: "Chinois",
        enLabel: "Anglais",
        frLabel: "FranÃ§ais",
        sizeLabel: "Taille de la police",
        colorLabel: "Couleur",
        orderLabel: "Ordre des sous-titres (Glisser pour ajuster)"
      },
      es: {
        title: "Generador de subtÃ­tulos de video en lote",
        subtitle: "Seleccione varios archivos de video para generar automÃ¡ticamente subtÃ­tulos en chino, inglÃ©s y francÃ©s",
        uploadButton: "ğŸ“¤ Subir y comenzar el procesamiento",
        statusTitle: "ğŸ“Š Estado del procesamiento",
        queueLabel: "Videos en cola:",
        pendingLabel: "Archivos pendientes:",
        completedLabel: "Videos completados:",
        processingLabel: "Estado del procesamiento:",
        tableOriginalFile: "Archivo original",
        tableNewFile: "Nuevo archivo",
        tableDuration: "Tiempo de procesamiento (segundos)",
        exportButton: "ğŸ“¥ Exportar a Excel",
        refreshButton: "ğŸ”„ Actualizar estado",
        noData: "AÃºn no hay videos completados",
        browse: "Examinar",
        noFilesSelected: "No se han seleccionado archivos",
        uploadSelect: "Por favor, seleccione archivos de video para subir",
        uploadProcessing: "Subiendo {count} archivo(s)...",
        uploadSuccess: "Subida exitosa",
        uploadError: "Fallo en la subida, por favor intenta de nuevo",
        exportNoData: "No hay datos para exportar",
        exportSuccess: "Lista de videos completados exportada",
        statusError: "Error al obtener el estado",
        processingIdle: "Inactivo",
        processingQueue: "Esperando en la cola",
        progress_starting: "ğŸš€ Iniciando procesamiento...",
        progress_extracting_audio: "ğŸµ Extrayendo audio...",
        progress_transcribing: "ğŸ“ Transcribiendo audio a texto...",
        progress_translating_en: "ğŸŒ Traduciendo al inglÃ©s...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· Traduciendo al francÃ©s...",
        progress_merging_subtitles: "ğŸ¬ Fusionando subtÃ­tulos en el video...",
        progress_generic: "ğŸ“Š Procesando... ({progress}%)",
        subtitleSettings: "ConfiguraciÃ³n de subtÃ­tulos",
        zhLabel: "Chino",
        enLabel: "InglÃ©s",
        frLabel: "FrancÃ©s",
        sizeLabel: "TamaÃ±o de fuente",
        colorLabel: "Color",
        orderLabel: "Orden de subtÃ­tulos (Arrastrar para ajustar)"
      },
      de: {
        title: "Stapel-Video-Untertitel-Generator",
        subtitle: "WÃ¤hlen Sie mehrere Videodateien aus, um automatisch Untertitel in Chinesisch, Englisch und FranzÃ¶sisch zu generieren",
        uploadButton: "ğŸ“¤ Hochladen und Verarbeitung starten",
        statusTitle: "ğŸ“Š Verarbeitungsstatus",
        queueLabel: "Videos in der Warteschlange:",
        pendingLabel: "Ausstehende Dateien:",
        completedLabel: "Abgeschlossene Videos:",
        processingLabel: "Verarbeitungsstatus:",
        tableOriginalFile: "Originaldatei",
        tableNewFile: "Neue Datei",
        tableDuration: "Verarbeitungszeit (Sekunden)",
        exportButton: "ğŸ“¥ Nach Excel exportieren",
        refreshButton: "ğŸ”„ Status aktualisieren",
        noData: "Noch keine abgeschlossenen Videos",
        browse: "Durchsuchen",
        noFilesSelected: "Keine Dateien ausgewÃ¤hlt",
        uploadSelect: "Bitte wÃ¤hlen Sie Videodateien zum Hochladen aus",
        uploadProcessing: "Hochladen von {count} Datei(en)...",
        uploadSuccess: "Hochladen erfolgreich",
        uploadError: "Hochladen fehlgeschlagen, bitte versuchen Sie es erneut",
        exportNoData: "Keine Daten zum Exportieren",
        exportSuccess: "Liste der abgeschlossenen Videos exportiert",
        statusError: "Fehler beim Abrufen des Status",
        processingIdle: "Inaktiv",
        processingQueue: "In der Warteschlange",
        progress_starting: "ğŸš€ Verarbeitung starten...",
        progress_extracting_audio: "ğŸµ Audio extrahieren...",
        progress_transcribing: "ğŸ“ Audio in Text umwandeln...",
        progress_translating_en: "ğŸŒ In Englisch Ã¼bersetzen...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· In FranzÃ¶sisch Ã¼bersetzen...",
        progress_merging_subtitles: "ğŸ¬ Untertitel in Video einfÃ¼gen...",
        progress_generic: "ğŸ“Š Verarbeiten... ({progress}%)",
        subtitleSettings: "Untertitel-Einstellungen",
        zhLabel: "Chinesisch",
        enLabel: "Englisch",
        frLabel: "FranzÃ¶sisch",
        sizeLabel: "SchriftgrÃ¶ÃŸe",
        colorLabel: "Farbe",
        orderLabel: "Untertitel-Reihenfolge (Ziehen zum Anpassen)"
      },
      it: {
        title: "Generatore di sottotitoli video in batch",
        subtitle: "Seleziona piÃ¹ file video per generare automaticamente sottotitoli in cinese, inglese e francese",
        uploadButton: "ğŸ“¤ Carica e avvia l'elaborazione",
        statusTitle: "ğŸ“Š Stato dell'elaborazione",
        queueLabel: "Video in coda:",
        pendingLabel: "File in attesa:",
        completedLabel: "Video completati:",
        processingLabel: "Stato dell'elaborazione:",
        tableOriginalFile: "File originale",
        tableNewFile: "Nuovo file",
        tableDuration: "Tempo di elaborazione (secondi)",
        exportButton: "ğŸ“¥ Esporta in Excel",
        refreshButton: "ğŸ”„ Aggiorna stato",
        noData: "Nessun video completato finora",
        browse: "Sfoglia",
        noFilesSelected: "Nessun file selezionato",
        uploadSelect: "Seleziona i file video da caricare",
        uploadProcessing: "Caricamento di {count} file...",
        uploadSuccess: "Caricamento completato",
        uploadError: "Caricamento fallito, riprova",
        exportNoData: "Nessun dato da esportare",
        exportSuccess: "Elenco dei video completati esportato",
        statusError: "Errore nel recupero dello stato",
        processingIdle: "Inattivo",
        processingQueue: "In attesa nella coda",
        progress_starting: "ğŸš€ Avvio dell'elaborazione...",
        progress_extracting_audio: "ğŸµ Estrazione audio...",
        progress_transcribing: "ğŸ“ Trascrizione audio in testo...",
        progress_translating_en: "ğŸŒ Traduzione in inglese...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· Traduzione in francese...",
        progress_merging_subtitles: "ğŸ¬ Incorporamento dei sottotitoli nel video...",
        progress_generic: "ğŸ“Š Elaborazione... ({progress}%)",
        subtitleSettings: "Impostazioni dei sottotitoli",
        zhLabel: "Cinese",
        enLabel: "Inglese",
        frLabel: "Francese",
        sizeLabel: "Dimensione del carattere",
        colorLabel: "Colore",
        orderLabel: "Ordine dei sottotitoli (Trascina per regolare)"
      },
      'zh-CN': {
        title: "æ‰¹é‡è§†é¢‘å­—å¹•ç”Ÿæˆå™¨",
        subtitle: "é€‰æ‹©å¤šä¸ªè§†é¢‘æ–‡ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸­æ–‡ã€è‹±æ–‡å’Œæ³•æ–‡å­—å¹•",
        uploadButton: "ğŸ“¤ ä¸Šä¼ å¹¶å¼€å§‹å¤„ç†",
        statusTitle: "ğŸ“Š å¤„ç†çŠ¶æ€",
        queueLabel: "é˜Ÿåˆ—ä¸­çš„è§†é¢‘ï¼š",
        pendingLabel: "å¾…å¤„ç†æ–‡ä»¶ï¼š",
        completedLabel: "å·²å®Œæˆè§†é¢‘ï¼š",
        processingLabel: "å¤„ç†çŠ¶æ€ï¼š",
        tableOriginalFile: "åŸå§‹æ–‡ä»¶",
        tableNewFile: "æ–°æ–‡ä»¶",
        tableDuration: "å¤„ç†è€—æ—¶ï¼ˆç§’ï¼‰",
        exportButton: "ğŸ“¥ å¯¼å‡ºä¸º Excel",
        refreshButton: "ğŸ”„ åˆ·æ–°çŠ¶æ€",
        noData: "æš‚æ— å·²å®Œæˆè§†é¢‘",
        browse: "æµè§ˆ",
        noFilesSelected: "æ— æ–‡ä»¶é€‰æ‹©",
        uploadSelect: "è¯·é€‰æ‹©è¦ä¸Šä¼ çš„è§†é¢‘æ–‡ä»¶",
        uploadProcessing: "æ­£åœ¨ä¸Šä¼  {count} ä¸ªæ–‡ä»¶...",
        uploadSuccess: "ä¸Šä¼ æˆåŠŸ",
        uploadError: "ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•",
        exportNoData: "æš‚æ— æ•°æ®å¯å¯¼å‡º",
        exportSuccess: "å·²å¯¼å‡ºå®Œæˆè§†é¢‘åˆ—è¡¨",
        statusError: "çŠ¶æ€è·å–å¤±è´¥",
        processingIdle: "ç©ºé—²",
        processingQueue: "é˜Ÿåˆ—ç­‰å¾…ä¸­",
        progress_starting: "ğŸš€ å¼€å§‹å¤„ç†...",
        progress_extracting_audio: "ğŸµ æå–éŸ³é¢‘...",
        progress_transcribing: "ğŸ“ è¯­éŸ³è½¬æ–‡å­—...",
        progress_translating_en: "ğŸŒ ç¿»è¯‘æˆè‹±æ–‡...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· ç¿»è¯‘æˆæ³•æ–‡...",
        progress_merging_subtitles: "ğŸ¬ åˆå¹¶å­—å¹•åˆ°è§†é¢‘...",
        progress_generic: "ğŸ“Š å¤„ç†ä¸­... ({progress}%)",
        subtitleSettings: "å­—å¹•è®¾ç½®",
        zhLabel: "ä¸­æ–‡",
        enLabel: "è‹±æ–‡",
        frLabel: "æ³•æ–‡",
        sizeLabel: "å­—ä½“å¤§å°",
        colorLabel: "é¢œè‰²",
        orderLabel: "å­—å¹•æ’åˆ—é¡ºåºï¼ˆæ‹–åŠ¨è°ƒæ•´ï¼‰"
      },
      'zh-TW': {
        title: "æ‰¹é‡å½±ç‰‡å­—å¹•ç”Ÿæˆå™¨",
        subtitle: "é¸æ“‡å¤šå€‹å½±ç‰‡æª”æ¡ˆï¼Œè‡ªå‹•ç”Ÿæˆä¸­æ–‡ã€è‹±æ–‡å’Œæ³•æ–‡å­—å¹•",
        uploadButton: "ğŸ“¤ ä¸Šå‚³ä¸¦é–‹å§‹è™•ç†",
        statusTitle: "ğŸ“Š è™•ç†ç‹€æ…‹",
        queueLabel: "éšŠåˆ—ä¸­çš„å½±ç‰‡ï¼š",
        pendingLabel: "å¾…è™•ç†æª”æ¡ˆï¼š",
        completedLabel: "å·²å®Œæˆå½±ç‰‡ï¼š",
        processingLabel: "è™•ç†ç‹€æ…‹ï¼š",
        tableOriginalFile: "åŸå§‹æª”æ¡ˆ",
        tableNewFile: "æ–°æª”æ¡ˆ",
        tableDuration: "è½‰æ›è€—æ™‚ï¼ˆç§’ï¼‰",
        exportButton: "ğŸ“¥ åŒ¯å‡ºç‚º Excel",
        refreshButton: "ğŸ”„ åˆ·æ–°ç‹€æ…‹",
        noData: "æš«ç„¡å·²å®Œæˆå½±ç‰‡",
        browse: "ç€è¦½",
        noFilesSelected: "ç„¡æª”æ¡ˆé¸æ“‡",
        uploadSelect: "è«‹é¸æ“‡è¦ä¸Šå‚³çš„å½±ç‰‡æª”æ¡ˆ",
        uploadProcessing: "æ­£åœ¨ä¸Šå‚³ {count} å€‹æª”æ¡ˆ...",
        uploadSuccess: "ä¸Šå‚³æˆåŠŸ",
        uploadError: "ä¸Šå‚³å¤±æ•—ï¼Œè«‹é‡è©¦",
        exportNoData: "æš«ç„¡è³‡æ–™å¯åŒ¯å‡º",
        exportSuccess: "å·²åŒ¯å‡ºå®Œæˆå½±ç‰‡åˆ—è¡¨",
        statusError: "ç‹€æ…‹ç²å–å¤±æ•—",
        processingIdle: "ç©ºé–’",
        processingQueue: "éšŠåˆ—ç­‰å¾…ä¸­",
        progress_starting: "ğŸš€ é–‹å§‹è™•ç†...",
        progress_extracting_audio: "ğŸµ æå–éŸ³é »...",
        progress_transcribing: "ğŸ“ èªéŸ³è½‰æ–‡å­—...",
        progress_translating_en: "ğŸŒ ç¿»è­¯æˆè‹±æ–‡...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· ç¿»è­¯æˆæ³•æ–‡...",
        progress_merging_subtitles: "ğŸ¬ åˆä½µå­—å¹•åˆ°å½±ç‰‡...",
        progress_generic: "ğŸ“Š è™•ç†ä¸­... ({progress}%)",
        subtitleSettings: "å­—å¹•è¨­å®š",
        zhLabel: "ä¸­æ–‡",
        enLabel: "è‹±æ–‡",
        frLabel: "æ³•æ–‡",
        sizeLabel: "å­—é«”å¤§å°",
        colorLabel: "é¡è‰²",
        orderLabel: "å­—å¹•æ’åˆ—é †åºï¼ˆæ‹–æ›³èª¿æ•´ï¼‰"
      },
      ja: {
        title: "ãƒãƒƒãƒãƒ“ãƒ‡ã‚ªå­—å¹•ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼",
        subtitle: "è¤‡æ•°ã®ãƒ“ãƒ‡ã‚ªãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ã€ä¸­å›½èªã€è‹±èªã€ãƒ•ãƒ©ãƒ³ã‚¹èªã®å­—å¹•ã‚’è‡ªå‹•ç”Ÿæˆ",
        uploadButton: "ğŸ“¤ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦å‡¦ç†é–‹å§‹",
        statusTitle: "ğŸ“Š å‡¦ç†çŠ¶æ…‹",
        queueLabel: "ã‚­ãƒ¥ãƒ¼å†…ã®ãƒ“ãƒ‡ã‚ªï¼š",
        pendingLabel: "ä¿ç•™ä¸­ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼š",
        completedLabel: "å®Œäº†ã—ãŸãƒ“ãƒ‡ã‚ªï¼š",
        processingLabel: "å‡¦ç†çŠ¶æ…‹ï¼š",
        tableOriginalFile: "å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«",
        tableNewFile: "æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«",
        tableDuration: "å‡¦ç†æ™‚é–“ï¼ˆç§’ï¼‰",
        exportButton: "ğŸ“¥ Excelã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ",
        refreshButton: "ğŸ”„ çŠ¶æ…‹ã‚’æ›´æ–°",
        noData: "ã¾ã å®Œäº†ã—ãŸãƒ“ãƒ‡ã‚ªã¯ã‚ã‚Šã¾ã›ã‚“",
        browse: "å‚ç…§",
        noFilesSelected: "ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“",
        uploadSelect: "ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãƒ“ãƒ‡ã‚ªãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„",
        uploadProcessing: "{count} ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...",
        uploadSuccess: "ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸ",
        uploadError: "ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸã€å†åº¦ãŠè©¦ã—ãã ã•ã„",
        exportNoData: "ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“",
        exportSuccess: "å®Œäº†ã—ãŸãƒ“ãƒ‡ã‚ªãƒªã‚¹ãƒˆã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ",
        statusError: "çŠ¶æ…‹ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ",
        processingIdle: "ã‚¢ã‚¤ãƒ‰ãƒ«",
        processingQueue: "ã‚­ãƒ¥ãƒ¼ã§å¾…æ©Ÿä¸­",
        progress_starting: "ğŸš€ å‡¦ç†ã‚’é–‹å§‹...",
        progress_extracting_audio: "ğŸµ ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚’æŠ½å‡º...",
        progress_transcribing: "ğŸ“ éŸ³å£°ã‚’ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›...",
        progress_translating_en: "ğŸŒ è‹±èªã«ç¿»è¨³...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· ãƒ•ãƒ©ãƒ³ã‚¹èªã«ç¿»è¨³...",
        progress_merging_subtitles: "ğŸ¬ å­—å¹•ã‚’ãƒ“ãƒ‡ã‚ªã«çµ±åˆ...",
        progress_generic: "ğŸ“Š å‡¦ç†ä¸­... ({progress}%)",
        subtitleSettings: "å­—å¹•è¨­å®š",
        zhLabel: "ä¸­å›½èª",
        enLabel: "è‹±èª",
        frLabel: "ãƒ•ãƒ©ãƒ³ã‚¹èª",
        sizeLabel: "ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º",
        colorLabel: "è‰²",
        orderLabel: "å­—å¹•ã®é †åºï¼ˆãƒ‰ãƒ©ãƒƒã‚°ã—ã¦èª¿æ•´ï¼‰"
      },
      ko: {
        title: "ì¼ê´„ ë¹„ë””ì˜¤ ìë§‰ ìƒì„±ê¸°",
        subtitle: "ì—¬ëŸ¬ ë¹„ë””ì˜¤ íŒŒì¼ì„ ì„ íƒí•˜ì—¬ ì¤‘êµ­ì–´, ì˜ì–´, í”„ë‘ìŠ¤ì–´ ìë§‰ì„ ìë™ ìƒì„±",
        uploadButton: "ğŸ“¤ ì—…ë¡œë“œ ë° ì²˜ë¦¬ ì‹œì‘",
        statusTitle: "ğŸ“Š ì²˜ë¦¬ ìƒíƒœ",
        queueLabel: "ëŒ€ê¸°ì—´ì˜ ë¹„ë””ì˜¤:",
        pendingLabel: "ëŒ€ê¸° ì¤‘ì¸ íŒŒì¼:",
        completedLabel: "ì™„ë£Œëœ ë¹„ë””ì˜¤:",
        processingLabel: "ì²˜ë¦¬ ìƒíƒœ:",
        tableOriginalFile: "ì›ë³¸ íŒŒì¼",
        tableNewFile: "ìƒˆ íŒŒì¼",
        tableDuration: "ì²˜ë¦¬ ì‹œê°„(ì´ˆ)",
        exportButton: "ğŸ“¥ Excelë¡œ ë‚´ë³´ë‚´ê¸°",
        refreshButton: "ğŸ”„ ìƒíƒœ ìƒˆë¡œê³ ì¹¨",
        noData: "ì•„ì§ ì™„ë£Œëœ ë¹„ë””ì˜¤ê°€ ì—†ìŠµë‹ˆë‹¤",
        browse: "ì°¾ì•„ë³´ê¸°",
        noFilesSelected: "ì„ íƒëœ íŒŒì¼ ì—†ìŒ",
        uploadSelect: "ì—…ë¡œë“œí•  ë¹„ë””ì˜¤ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”",
        uploadProcessing: "{count}ê°œ íŒŒì¼ ì—…ë¡œë“œ ì¤‘...",
        uploadSuccess: "ì—…ë¡œë“œ ì„±ê³µ",
        uploadError: "ì—…ë¡œë“œ ì‹¤íŒ¨, ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”",
        exportNoData: "ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤",
        exportSuccess: "ì™„ë£Œëœ ë¹„ë””ì˜¤ ëª©ë¡ì´ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤",
        statusError: "ìƒíƒœë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤",
        processingIdle: "ìœ íœ´",
        processingQueue: "ëŒ€ê¸°ì—´ì—ì„œ ëŒ€ê¸° ì¤‘",
        progress_starting: "ğŸš€ ì²˜ë¦¬ ì‹œì‘...",
        progress_extracting_audio: "ğŸµ ì˜¤ë””ì˜¤ ì¶”ì¶œ...",
        progress_transcribing: "ğŸ“ ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜...",
        progress_translating_en: "ğŸŒ ì˜ì–´ë¡œ ë²ˆì—­...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· í”„ë‘ìŠ¤ì–´ë¡œ ë²ˆì—­...",
        progress_merging_subtitles: "ğŸ¬ ìë§‰ì„ ë¹„ë””ì˜¤ì— í†µí•©...",
        progress_generic: "ğŸ“Š ì²˜ë¦¬ ì¤‘... ({progress}%)",
        subtitleSettings: "ìë§‰ ì„¤ì •",
        zhLabel: "ì¤‘êµ­ì–´",
        enLabel: "ì˜ì–´",
        frLabel: "í”„ë‘ìŠ¤ì–´",
        sizeLabel: "ê¸€ê¼´ í¬ê¸°",
        colorLabel: "ìƒ‰ìƒ",
        orderLabel: "ìë§‰ ìˆœì„œ (ë“œë˜ê·¸í•˜ì—¬ ì¡°ì •)"
      },
      hi: {
        title: "à¤¬à¥ˆà¤š à¤µà¥€à¤¡à¤¿à¤¯à¥‹ à¤‰à¤ªà¤¶à¥€à¤°à¥à¤·à¤• à¤œà¤¨à¤°à¥‡à¤Ÿà¤°",
        subtitle: "à¤•à¤ˆ à¤µà¥€à¤¡à¤¿à¤¯à¥‹ à¤«à¤¼à¤¾à¤‡à¤²à¥‹à¤‚ à¤•à¤¾ à¤šà¤¯à¤¨ à¤•à¤°à¥‡à¤‚ à¤¤à¤¾à¤•à¤¿ à¤šà¥€à¤¨à¥€, à¤…à¤‚à¤—à¥à¤°à¥‡à¤œà¥€ à¤”à¤° à¤«à¥à¤°à¥‡à¤‚à¤š à¤‰à¤ªà¤¶à¥€à¤°à¥à¤·à¤• à¤¸à¥à¤µà¤šà¤¾à¤²à¤¿à¤¤ à¤°à¥‚à¤ª à¤¸à¥‡ à¤‰à¤¤à¥à¤ªà¤¨à¥à¤¨ à¤¹à¥‹",
        uploadButton: "ğŸ“¤ à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚ à¤”à¤° à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸à¤¿à¤‚à¤— à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚",
        statusTitle: "ğŸ“Š à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸à¤¿à¤‚à¤— à¤¸à¥à¤¥à¤¿à¤¤à¤¿",
        queueLabel: "à¤•à¤¤à¤¾à¤° à¤®à¥‡à¤‚ à¤µà¥€à¤¡à¤¿à¤¯à¥‹:",
        pendingLabel: "à¤²à¤‚à¤¬à¤¿à¤¤ à¤«à¤¼à¤¾à¤‡à¤²à¥‡à¤‚:",
        completedLabel: "à¤ªà¥‚à¤°à¥à¤£ à¤•à¤¿à¤ à¤—à¤ à¤µà¥€à¤¡à¤¿à¤¯à¥‹:",
        processingLabel: "à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸à¤¿à¤‚à¤— à¤¸à¥à¤¥à¤¿à¤¤à¤¿:",
        tableOriginalFile: "à¤®à¥‚à¤² à¤«à¤¼à¤¾à¤‡à¤²",
        tableNewFile: "à¤¨à¤ˆ à¤«à¤¼à¤¾à¤‡à¤²",
        tableDuration: "à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸à¤¿à¤‚à¤— à¤¸à¤®à¤¯ (à¤¸à¥‡à¤•à¤‚à¤¡)",
        exportButton: "ğŸ“¥ Excel à¤®à¥‡à¤‚ à¤¨à¤¿à¤°à¥à¤¯à¤¾à¤¤ à¤•à¤°à¥‡à¤‚",
        refreshButton: "ğŸ”„ à¤¸à¥à¤¥à¤¿à¤¤à¤¿ à¤¤à¤¾à¤œà¤¼à¤¾ à¤•à¤°à¥‡à¤‚",
        noData: "à¤…à¤­à¥€ à¤¤à¤• à¤•à¥‹à¤ˆ à¤ªà¥‚à¤°à¥à¤£ à¤µà¥€à¤¡à¤¿à¤¯à¥‹ à¤¨à¤¹à¥€à¤‚",
        browse: "à¤¬à¥à¤°à¤¾à¤‰à¤œà¤¼ à¤•à¤°à¥‡à¤‚",
        noFilesSelected: "à¤•à¥‹à¤ˆ à¤«à¤¼à¤¾à¤‡à¤² à¤šà¤¯à¤¨à¤¿à¤¤ à¤¨à¤¹à¥€à¤‚",
        uploadSelect: "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤µà¥€à¤¡à¤¿à¤¯à¥‹ à¤«à¤¼à¤¾à¤‡à¤²à¥‡à¤‚ à¤šà¥à¤¨à¥‡à¤‚",
        uploadProcessing: "{count} à¤«à¤¼à¤¾à¤‡à¤²(à¥‡à¤‚) à¤…à¤ªà¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆà¤‚...",
        uploadSuccess: "à¤…à¤ªà¤²à¥‹à¤¡ à¤¸à¤«à¤²",
        uploadError: "à¤…à¤ªà¤²à¥‹à¤¡ à¤µà¤¿à¤«à¤², à¤•à¥ƒà¤ªà¤¯à¤¾ à¤ªà¥à¤¨à¤ƒ à¤ªà¥à¤°à¤¯à¤¾à¤¸ à¤•à¤°à¥‡à¤‚",
        exportNoData: "à¤¨à¤¿à¤°à¥à¤¯à¤¾à¤¤ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥‹à¤ˆ à¤¡à¥‡à¤Ÿà¤¾ à¤¨à¤¹à¥€à¤‚",
        exportSuccess: "à¤ªà¥‚à¤°à¥à¤£ à¤µà¥€à¤¡à¤¿à¤¯à¥‹ à¤¸à¥‚à¤šà¥€ à¤¨à¤¿à¤°à¥à¤¯à¤¾à¤¤ à¤•à¥€ à¤—à¤ˆ",
        statusError: "à¤¸à¥à¤¥à¤¿à¤¤à¤¿ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¤¨à¥‡ à¤®à¥‡à¤‚ à¤µà¤¿à¤«à¤²",
        processingIdle: "à¤¨à¤¿à¤·à¥à¤•à¥à¤°à¤¿à¤¯",
        processingQueue: "à¤•à¤¤à¤¾à¤° à¤®à¥‡à¤‚ à¤ªà¥à¤°à¤¤à¥€à¤•à¥à¤·à¤¾",
        progress_starting: "ğŸš€ à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸à¤¿à¤‚à¤— à¤¶à¥à¤°à¥‚...",
        progress_extracting_audio: "ğŸµ à¤‘à¤¡à¤¿à¤¯à¥‹ à¤¨à¤¿à¤•à¤¾à¤² à¤°à¤¹à¤¾ à¤¹à¥ˆ...",
        progress_transcribing: "ğŸ“ à¤‘à¤¡à¤¿à¤¯à¥‹ à¤•à¥‹ à¤Ÿà¥‡à¤•à¥à¤¸à¥à¤Ÿ à¤®à¥‡à¤‚ à¤ªà¤°à¤¿à¤µà¤°à¥à¤¤à¤¿à¤¤ à¤•à¤° à¤°à¤¹à¤¾ à¤¹à¥ˆ...",
        progress_translating_en: "ğŸŒ à¤…à¤‚à¤—à¥à¤°à¥‡à¤œà¥€ à¤®à¥‡à¤‚ à¤…à¤¨à¥à¤µà¤¾à¤¦...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· à¤«à¥à¤°à¥‡à¤‚à¤š à¤®à¥‡à¤‚ à¤…à¤¨à¥à¤µà¤¾à¤¦...",
        progress_merging_subtitles: "ğŸ¬ à¤‰à¤ªà¤¶à¥€à¤°à¥à¤·à¤• à¤•à¥‹ à¤µà¥€à¤¡à¤¿à¤¯à¥‹ à¤®à¥‡à¤‚ à¤®à¤°à¥à¤œ à¤•à¤° à¤°à¤¹à¤¾ à¤¹à¥ˆ...",
        progress_generic: "ğŸ“Š à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸à¤¿à¤‚à¤—... ({progress}%)",
        subtitleSettings: "à¤‰à¤ªà¤¶à¥€à¤°à¥à¤·à¤• à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—à¥à¤¸",
        zhLabel: "à¤šà¥€à¤¨à¥€",
        enLabel: "à¤…à¤‚à¤—à¥à¤°à¥‡à¤œà¥€",
        frLabel: "à¤«à¥à¤°à¥‡à¤‚à¤š",
        sizeLabel: "à¤«à¤¼à¥‰à¤¨à¥à¤Ÿ à¤†à¤•à¤¾à¤°",
        colorLabel: "à¤°à¤‚à¤—",
        orderLabel: "à¤‰à¤ªà¤¶à¥€à¤°à¥à¤·à¤• à¤•à¥à¤°à¤® (à¤–à¥€à¤‚à¤šà¤•à¤° à¤¸à¤®à¤¾à¤¯à¥‹à¤œà¤¿à¤¤ à¤•à¤°à¥‡à¤‚)"
      },
      th: {
        title: "à¸•à¸±à¸§à¸ªà¸£à¹‰à¸²à¸‡à¸„à¸³à¸šà¸£à¸£à¸¢à¸²à¸¢à¸§à¸´à¸”à¸µà¹‚à¸­à¹à¸šà¸šà¹à¸šà¸—à¸Šà¹Œ",
        subtitle: "à¹€à¸¥à¸·à¸­à¸à¹„à¸Ÿà¸¥à¹Œà¸§à¸´à¸”à¸µà¹‚à¸­à¸«à¸¥à¸²à¸¢à¹„à¸Ÿà¸¥à¹Œà¹€à¸à¸·à¹ˆà¸­à¸ªà¸£à¹‰à¸²à¸‡à¸„à¸³à¸šà¸£à¸£à¸¢à¸²à¸¢à¸ à¸²à¸©à¸²à¸ˆà¸µà¸™ à¸­à¸±à¸‡à¸à¸¤à¸© à¹à¸¥à¸°à¸à¸£à¸±à¹ˆà¸‡à¹€à¸¨à¸ªà¹‚à¸”à¸¢à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´",
        uploadButton: "ğŸ“¤ à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¹à¸¥à¸°à¹€à¸£à¸´à¹ˆà¸¡à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥",
        statusTitle: "ğŸ“Š à¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥",
        queueLabel: "à¸§à¸´à¸”à¸µà¹‚à¸­à¹ƒà¸™à¸„à¸´à¸§:",
        pendingLabel: "à¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¸£à¸­à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£:",
        completedLabel: "à¸§à¸´à¸”à¸µà¹‚à¸­à¸—à¸µà¹ˆà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ:",
        processingLabel: "à¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥:",
        tableOriginalFile: "à¹„à¸Ÿà¸¥à¹Œà¸•à¹‰à¸™à¸‰à¸šà¸±à¸š",
        tableNewFile: "à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸«à¸¡à¹ˆ",
        tableDuration: "à¹€à¸§à¸¥à¸²à¸à¸²à¸£à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥ (à¸§à¸´à¸™à¸²à¸—à¸µ)",
        exportButton: "ğŸ“¥ à¸ªà¹ˆà¸‡à¸­à¸­à¸à¹€à¸›à¹‡à¸™ Excel",
        refreshButton: "ğŸ”„ à¸£à¸µà¹€à¸Ÿà¸£à¸Šà¸ªà¸–à¸²à¸™à¸°",
        noData: "à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸§à¸´à¸”à¸µà¹‚à¸­à¸—à¸µà¹ˆà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ",
        browse: "à¹€à¸£à¸µà¸¢à¸à¸”à¸¹",
        noFilesSelected: "à¹„à¸¡à¹ˆà¸¡à¸µà¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¹€à¸¥à¸·à¸­à¸",
        uploadSelect: "à¹‚à¸›à¸£à¸”à¹€à¸¥à¸·à¸­à¸à¹„à¸Ÿà¸¥à¹Œà¸§à¸´à¸”à¸µà¹‚à¸­à¹€à¸à¸·à¹ˆà¸­à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”",
        uploadProcessing: "à¸à¸³à¸¥à¸±à¸‡à¸­à¸±à¸›à¹‚à¸«à¸¥à¸” {count} à¹„à¸Ÿà¸¥à¹Œ...",
        uploadSuccess: "à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¸ªà¸³à¹€à¸£à¹‡à¸ˆ",
        uploadError: "à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§ à¹‚à¸›à¸£à¸”à¸¥à¸­à¸‡à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡",
        exportNoData: "à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¹‰à¸ªà¹ˆà¸‡à¸­à¸­à¸",
        exportSuccess: "à¸ªà¹ˆà¸‡à¸­à¸­à¸à¸§à¸´à¸”à¸µà¹‚à¸­à¸—à¸µà¹ˆà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œà¹à¸¥à¹‰à¸§",
        statusError: "à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸”à¸¶à¸‡à¸ªà¸–à¸²à¸™à¸°à¹„à¸”à¹‰",
        processingIdle: "à¸§à¹ˆà¸²à¸‡",
        processingQueue: "à¸£à¸­à¹ƒà¸™à¸„à¸´à¸§",
        progress_starting: "ğŸš€ à¹€à¸£à¸´à¹ˆà¸¡à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥...",
        progress_extracting_audio: "ğŸµ à¹à¸¢à¸à¹€à¸ªà¸µà¸¢à¸‡...",
        progress_transcribing: "ğŸ“ à¹à¸›à¸¥à¸‡à¹€à¸ªà¸µà¸¢à¸‡à¹€à¸›à¹‡à¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡...",
        progress_translating_en: "ğŸŒ à¹à¸›à¸¥à¹€à¸›à¹‡à¸™à¸ à¸²à¸©à¸²à¸­à¸±à¸‡à¸à¸¤à¸©...",
        progress_translating_fr: "ğŸ‡«ğŸ‡· à¹à¸›à¸¥à¹€à¸›à¹‡à¸™à¸ à¸²à¸©à¸²à¸à¸£à¸±à¹ˆà¸‡à¹€à¸¨à¸ª...",
        progress_merging_subtitles: "ğŸ¬ à¸£à¸§à¸¡à¸„à¸³à¸šà¸£à¸£à¸¢à¸²à¸¢à¹€à¸‚à¹‰à¸²à¸à¸±à¸šà¸§à¸´à¸”à¸µà¹‚à¸­...",
        progress_generic: "ğŸ“Š à¸à¸³à¸¥à¸±à¸‡à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥... ({progress}%)",
        subtitleSettings: "à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸„à¸³à¸šà¸£à¸£à¸¢à¸²à¸¢",
        zhLabel: "à¸ˆà¸µà¸™",
        enLabel: "à¸­à¸±à¸‡à¸à¸¤à¸©",
        frLabel: "à¸à¸£à¸±à¹ˆà¸‡à¹€à¸¨à¸ª",
        sizeLabel: "à¸‚à¸™à¸²à¸”à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£",
        colorLabel: "à¸ªà¸µ",
        orderLabel: "à¸¥à¸³à¸”à¸±à¸šà¸„à¸³à¸šà¸£à¸£à¸¢à¸²à¸¢ (à¸¥à¸²à¸à¹€à¸à¸·à¹ˆà¸­à¸›à¸£à¸±à¸š)"
      }
    };

    let eventSource = null;
    let currentLanguage = localStorage.getItem('language') || 'zh-TW';

    function setLanguage(lang) {
      currentLanguage = lang;
      localStorage.setItem('language', lang);
      updateTranslations();
    }

    function updateTranslations() {
      document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        element.textContent = translations[currentLanguage][key] || key;
      });
      updateFileStatus();
      fetchStatus();
      updateProgressDisplay(currentProgress || {});
    }

    let currentProgress = {};

    document.getElementById('languageSelect').addEventListener('change', (e) => {
      setLanguage(e.target.value);
    });

    document.querySelector('button[data-i18n="browse"]').addEventListener('click', () => {
      document.getElementById('video-files').click();
    });

    document.getElementById('video-files').addEventListener('change', () => {
      updateFileStatus();
    });

    function updateFileStatus() {
      const fileInput = document.getElementById('video-files');
      const fileStatus = document.getElementById('file-status');
      if (fileInput.files.length > 0) {
        fileStatus.textContent = `${fileInput.files.length} ${translations[currentLanguage].uploadProcessing.split(' ')[1]}`;
      } else {
        fileStatus.textContent = translations[currentLanguage].noFilesSelected;
      }
    }

    document.getElementById('languageSelect').value = currentLanguage;
    setLanguage(currentLanguage);

    function showUploadStatus(message, type = 'info') {
      const container = document.getElementById('upload-status-container');
      message = message.replace('{count}', document.getElementById('video-files').files.length);
      container.innerHTML = `<div class="upload-status ${type}">${message}</div>`;
    }

    function uploadVideos() {
      const files = document.getElementById('video-files').files;
      const uploadBtn = document.getElementById('upload-btn');
      
      if (files.length === 0) {
        showUploadStatus(translations[currentLanguage].uploadSelect, 'error');
        return;
      }

      const formData = new FormData();
      for (const file of files) {
        formData.append('videos', file);
      }

      // Add subtitle settings
      const subtitleSettings = {
        zh: {
          font: document.getElementById('zh-font').value,
          size: parseInt(document.getElementById('zh-size').value),
          color: document.getElementById('zh-color').value.replace('#', '&H00')
        },
        en: {
          font: document.getElementById('en-font').value,
          size: parseInt(document.getElementById('en-size').value),
          color: document.getElementById('en-color').value.replace('#', '&H00')
        },
        fr: {
          font: document.getElementById('fr-font').value,
          size: parseInt(document.getElementById('fr-size').value),
          color: document.getElementById('fr-color').value.replace('#', '&H00')
        },
        order: Array.from(document.querySelectorAll('#order-list .order-item')).map(item => item.dataset.lang)
      };
      formData.append('subtitleSettings', JSON.stringify(subtitleSettings));

      uploadBtn.disabled = true;
      uploadBtn.textContent = translations[currentLanguage].uploadButton.replace('ğŸ“¤ ', 'â³ ');
      showUploadStatus(translations[currentLanguage].uploadProcessing, 'info');

      fetch('/upload', {
        method: 'POST',
        body: formData
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        showUploadStatus(translations[currentLanguage].uploadSuccess, 'success');
        fetchStatus();
        startProgressStreaming();
        document.getElementById('video-files').value = '';
        updateFileStatus();
      })
      .catch(error => {
        console.error('Upload error:', error);
        showUploadStatus(translations[currentLanguage].uploadError, 'error');
      })
      .finally(() => {
        uploadBtn.disabled = false;
        uploadBtn.textContent = translations[currentLanguage].uploadButton;
      });
    }

    function fetchStatus() {
      fetch('/status')
      .then(response => response.json())
      .then(data => {
        document.getElementById('queue-count').textContent = data.queue.length;
        document.getElementById('pending-count').textContent = data.pending;
        document.getElementById('completed-count').textContent = data.completed;
        
        const processingStatus = document.getElementById('processing-status');
        if (data.isProcessing && data.currentFile) {
          processingStatus.textContent = `${translations[currentLanguage].processingLabel} ${data.currentFile}`;
          processingStatus.style.color = '#28a745';
        } else if (data.queue.length > 0) {
          processingStatus.textContent = translations[currentLanguage].processingQueue;
          processingStatus.style.color = '#ffc107';
        } else {
          processingStatus.textContent = translations[currentLanguage].processingIdle;
          processingStatus.style.color = '#6c757d';
        }

        const completedVideosBody = document.getElementById('completed-videos-body');
        completedVideosBody.innerHTML = '';
        if (data.completedVideos && data.completedVideos.length > 0) {
          data.completedVideos.forEach(video => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${video.originalFile}</td>
              <td>${video.newFile}</td>
              <td>${video.duration.toFixed(2)}</td>
            `;
            completedVideosBody.appendChild(row);
          });
        } else {
          const row = document.createElement('tr');
          row.innerHTML = `<td colspan="3" style="text-align: center;">${translations[currentLanguage].noData}</td>`;
          completedVideosBody.appendChild(row);
        }
        updateTranslations();
      })
      .catch(error => {
        console.error('Error fetching status:', error);
        document.getElementById('processing-status').textContent = translations[currentLanguage].statusError;
      });
    }

    function exportToExcel() {
      const table = document.getElementById('completed-videos-table');
      const data = [];
      
      data.push([
        translations[currentLanguage].tableOriginalFile,
        translations[currentLanguage].tableNewFile,
        translations[currentLanguage].tableDuration
      ]);
      
      const tbody = document.getElementById('completed-videos-body');
      const dataRows = tbody.querySelectorAll('tr');
      dataRows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length === 3) {
          const rowData = [
            cells[0].textContent,
            cells[1].textContent,
            cells[2].textContent
          ];
          data.push(rowData);
        }
      });

      if (data.length === 1) {
        showUploadStatus(translations[currentLanguage].exportNoData, 'info');
        return;
      }

      const ws = XLSX.utils.aoa_to_sheet(data);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Completed Videos');
      XLSX.writeFile(wb, `completed_videos_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.xlsx`);
      showUploadStatus(translations[currentLanguage].exportSuccess, 'success');
    }

    function startProgressStreaming() {
      if (eventSource) {
        eventSource.close();
      }

      eventSource = new EventSource('/api/process-progress');
      
      eventSource.onmessage = function(event) {
        try {
          const progress = JSON.parse(event.data);
          currentProgress = progress;
          updateProgressDisplay(progress);
        } catch (error) {
          console.error('Error parsing progress data:', error);
        }
      };

      eventSource.onerror = function(error) {
        console.error('EventSource error:', error);
        setTimeout(() => {
          if (document.getElementById('pending-count').textContent !== '0') {
            startProgressStreaming();
          }
        }, 5000);
      };
    }

    function updateProgressDisplay(progress) {
      const progressSection = document.getElementById('progress-section');
      const currentFileEl = document.getElementById('current-file');
      const progressStepEl = document.getElementById('progress-step');
      
      if (progress.currentFile) {
        progressSection.style.display = 'block';
        currentFileEl.textContent = `${translations[currentLanguage].processingLabel} ${progress.currentFile}`;
        
        let stepText = translations[currentLanguage][`progress_${progress.step}`] || translations[currentLanguage].progress_generic.replace('{progress}', Math.round((progress.progress || 0) * 100));
        
        if (progress.videoIndex !== undefined && progress.totalVideos !== undefined) {
          stepText = `[${progress.videoIndex + 1}/${progress.totalVideos}] ${stepText}`;
        }
        
        progressStepEl.textContent = stepText;
      } else {
        progressSection.style.display = 'none';
      }
      
      if (progress.queueLength !== undefined) {
        document.getElementById('queue-count').textContent = progress.queueLength;
      }
      
      if (progress.step === 'merging_subtitles' && progress.progress === 1.0) {
        setTimeout(fetchStatus, 1000);
      }
    }

    // Drag and drop for subtitle order
    const orderList = document.getElementById('order-list');
    orderList.addEventListener('dragstart', (e) => {
      if (e.target.classList.contains('order-item')) {
        e.target.classList.add('dragging');
        e.dataTransfer.setData('text/plain', e.target.dataset.lang);
      }
    });
    orderList.addEventListener('dragend', (e) => {
      if (e.target.classList.contains('order-item')) {
        e.target.classList.remove('dragging');
      }
    });
    orderList.addEventListener('dragover', (e) => {
      e.preventDefault();
    });
    orderList.addEventListener('drop', (e) => {
      e.preventDefault();
      const draggedLang = e.dataTransfer.getData('text/plain');
      const draggedItem = document.querySelector(`.order-item[data-lang="${draggedLang}"]`);
      const dropTarget = e.target.closest('.order-item');
      if (dropTarget && dropTarget !== draggedItem) {
        const allItems = Array.from(orderList.querySelectorAll('.order-item'));
        const fromIndex = allItems.indexOf(draggedItem);
        const toIndex = allItems.indexOf(dropTarget);
        if (fromIndex < toIndex) {
          dropTarget.after(draggedItem);
        } else {
          dropTarget.before(draggedItem);
        }
      }
    });

    document.addEventListener('DOMContentLoaded', () => {
      fetchStatus();
      setTimeout(() => {
        const pendingCount = parseInt(document.getElementById('pending-count').textContent);
        if (pendingCount > 0) {
          startProgressStreaming();
        }
      }, 1000);
      setInterval(fetchStatus, 30000);
    });

    window.addEventListener('beforeunload', () => {
      if (eventSource) {
        eventSource.close();
      }
    });
  </script>
</body>
</html>